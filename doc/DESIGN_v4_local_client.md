# å°åŒ—æœ¬åœ°å®¢æˆ·ç«¯è®¾è®¡æ–¹æ¡ˆ

> **ç‰ˆæœ¬**: v4.0  
> **æ—¥æœŸ**: 2026-02-03  
> **æ ¸å¿ƒæ€æƒ³**: æ•´åˆä¸ºæœ¬åœ°å®¢æˆ·ç«¯ï¼Œæ–‡ä»¶ç”¨ VSCode æ”¹ï¼ŒThread å¯¹æ¥ï¼Œæ¨¡å‹èµ° xiaobei é…ç½®

---

## 1. æ ¸å¿ƒç†è§£

### 1.1 æ‚¨æƒ³è¦çš„

```
æœ¬åœ°å®¢æˆ·ç«¯ï¼ˆä¸æ˜¯ç½‘é¡µï¼‰
    â”‚
    â”œâ”€â–º æ–‡ä»¶æ“ä½œï¼šç›´æ¥ç”¨ VSCode æ”¹ï¼ˆä¸éœ€è¦ç½‘é¡µç¼–è¾‘å™¨ï¼‰
    â”‚
    â”œâ”€â–º Agent æ‰§è¡Œï¼šOpenclaw æœ¬åœ°æ‰§è¡Œèƒ½åŠ›
    â”‚
    â”œâ”€â–º Thread ç®¡ç†ï¼šå¯¹æ¥ north-app-core çš„ Thread æ¦‚å¿µ
    â”‚
    â”œâ”€â–º æ¨¡å‹é…ç½®ï¼šå¤ç”¨ xiaobei çš„é…ç½®æ ¼å¼
    â”‚
    â””â”€â–º å¯é€‰å¯¹æ¥ï¼šnorth-deer-flowï¼ˆæ·±åº¦ç ”ç©¶ç­‰ï¼‰
```

### 1.2 æœ€ç»ˆå½¢æ€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         æœ¬åœ°å®¢æˆ·ç«¯æ¶æ„                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                      ç”¨æˆ·äº¤äº’å±‚                                       â”‚  â”‚
â”‚   â”‚                                                                      â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚  â”‚
â”‚   â”‚   â”‚   ç»ˆç«¯ CLI   â”‚     â”‚   VSCode     â”‚     â”‚ æ¡Œé¢å®¢æˆ·ç«¯    â”‚       â”‚  â”‚
â”‚   â”‚   â”‚  (å‘½ä»¤è¡Œ)    â”‚     â”‚  (æ–‡ä»¶ç¼–è¾‘)  â”‚     â”‚  (å¯é€‰/åç»­)  â”‚       â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚              â”‚                                                             â”‚
â”‚              â”‚ æœ¬åœ°è°ƒç”¨                                                    â”‚
â”‚              â–¼                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                 Openclaw æœ¬åœ°å¼•æ“ï¼ˆæ ¸å¿ƒï¼‰                             â”‚  â”‚
â”‚   â”‚                                                                      â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚   â”‚  â”‚  å°åŒ—é…ç½®å…¼å®¹å±‚                                               â”‚   â”‚  â”‚
â”‚   â”‚  â”‚  - æ¨¡å‹é…ç½® (MAIN_AGENT, base_url, api_key, model)           â”‚   â”‚  â”‚
â”‚   â”‚  â”‚  - å·¥ä½œç©ºé—´é…ç½® (workspace_dir, working_dir)                  â”‚   â”‚  â”‚
â”‚   â”‚  â”‚  - ç§Ÿæˆ·/ç”¨æˆ·ä¿¡æ¯ (tenant_id, user_id)                         â”‚   â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚   â”‚                                                                      â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚   â”‚  â”‚  Thread ç®¡ç†                                                  â”‚   â”‚  â”‚
â”‚   â”‚  â”‚  - æœ¬åœ° SQLite å­˜å‚¨ Thread/Block                              â”‚   â”‚  â”‚
â”‚   â”‚  â”‚  - å…¼å®¹ north-app-core çš„ Thread ç»“æ„                         â”‚   â”‚  â”‚
â”‚   â”‚  â”‚  - æ”¯æŒå¯¹è¯å†å²ã€çŠ¶æ€ç®¡ç†                                      â”‚   â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚   â”‚                                                                      â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚   â”‚  â”‚  Agent Core                                                   â”‚   â”‚  â”‚
â”‚   â”‚  â”‚  - AI æ¨¡å‹è°ƒç”¨ï¼ˆèµ° xiaobei é…ç½®ï¼‰                              â”‚   â”‚  â”‚
â”‚   â”‚  â”‚  - å·¥å…·è°ƒç”¨åè°ƒ                                                â”‚   â”‚  â”‚
â”‚   â”‚  â”‚  - æµå¼å“åº”                                                   â”‚   â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚   â”‚                                                                      â”‚  â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚   â”‚  â”‚  å·¥å…·ç³»ç»Ÿ                                                     â”‚   â”‚  â”‚
â”‚   â”‚  â”‚                                                              â”‚   â”‚  â”‚
â”‚   â”‚  â”‚  æœ¬åœ°æ‰§è¡Œå·¥å…·ï¼ˆOpenclaw åŸç”Ÿï¼‰    å°åŒ—å·¥å…·ï¼ˆç§»æ¤ï¼‰              â”‚   â”‚  â”‚
â”‚   â”‚  â”‚  â”œâ”€â”€ file_read                   â”œâ”€â”€ feishu_*                â”‚   â”‚  â”‚
â”‚   â”‚  â”‚  â”œâ”€â”€ file_write                  â”œâ”€â”€ search                  â”‚   â”‚  â”‚
â”‚   â”‚  â”‚  â”œâ”€â”€ shell_exec                  â”œâ”€â”€ deep_research           â”‚   â”‚  â”‚
â”‚   â”‚  â”‚  â”œâ”€â”€ browser_*                   â””â”€â”€ ...                     â”‚   â”‚  â”‚
â”‚   â”‚  â”‚  â””â”€â”€ git_*                                                   â”‚   â”‚  â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚   å¯é€‰å¯¹æ¥:                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  north-deer-flowï¼ˆæ·±åº¦ç ”ç©¶æœåŠ¡ï¼Œå¦‚æœéœ€è¦ï¼‰                           â”‚  â”‚
â”‚   â”‚  - æœ¬åœ°å¼•æ“å¯ä»¥è°ƒç”¨ deer-flow çš„ API                                â”‚  â”‚
â”‚   â”‚  - æˆ–è€…ç›´æ¥åœ¨ Openclaw ä¸­å®ç°ç ”ç©¶èƒ½åŠ›                               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. æ ¸å¿ƒè®¾è®¡

### 2.1 é…ç½®å…¼å®¹ï¼ˆå¤ç”¨ xiaobei æ ¼å¼ï¼‰

```typescript
// å°åŒ—é…ç½®æ ¼å¼ï¼ˆOpenclaw éœ€è¦å…¼å®¹ï¼‰
interface XiaoBeiConfig {
  // åŸºç¡€ä¿¡æ¯
  BASE_INFO: {
    tenant_id: string;
    user_id: string;
    user_name: string;
    session_id: string;
    deploy_env: string;
  };
  
  // æ¨¡å‹é…ç½®ï¼ˆæ ¸å¿ƒï¼‰
  MAIN_AGENT: {
    base_url: string;     // ä¾‹å¦‚: https://api.anthropic.com
    api_key: string;      // API Key
    model: string;        // ä¾‹å¦‚: claude-sonnet-4
    api_type?: string;    // anthropic | openai | azure
  };
  
  // å¯é€‰çš„å…¶ä»– Agent é…ç½®
  DEEP_RESEARCH_AGENT?: {
    base_url: string;
    api_key: string;
    model: string;
  };
  
  // å·¥ä½œç©ºé—´
  workspace_dir: string;   // å·¥ä½œç©ºé—´ç›®å½•
  working_dir: string;     // å½“å‰å·¥ä½œç›®å½•
  
  // Thread é…ç½®
  thread_id?: string;      // å½“å‰ Thread ID
  
  // äº‹ä»¶æµï¼ˆå¯é€‰ï¼Œæœ¬åœ°å¯ä»¥ä¸ç”¨ï¼‰
  event_stream?: {
    url: string;
    api_key_header: string;
    api_key: string;
  };
}
```

### 2.2 Thread æœ¬åœ°å­˜å‚¨

```typescript
// Thread ç»“æ„ï¼ˆå…¼å®¹ north-app-coreï¼‰
interface Thread {
  thread_id: string;           // å”¯ä¸€æ ‡è¯†
  status: ThreadStatus;        // running | waiting | completed | error | aborted
  created_at: Date;
  updated_at: Date;
  
  // å…ƒæ•°æ®
  title?: string;
  workspace_dir?: string;
  
  // Block åˆ—è¡¨
  blocks: Block[];
}

interface Block {
  block_id: string;
  thread_id: string;
  parent_block_id?: string;
  
  sender: 'user' | 'agent' | 'tool' | 'system';
  type: 'text' | 'tool' | 'activity';
  
  // å†…å®¹
  content?: string;
  tool_name?: string;
  tool_input?: any;
  tool_output?: any;
  
  status: 'pending' | 'streaming' | 'completed' | 'error';
  created_at: Date;
}

// æœ¬åœ° SQLite å­˜å‚¨
// ~/.openclaw/threads.db
CREATE TABLE threads (
  thread_id TEXT PRIMARY KEY,
  status TEXT,
  title TEXT,
  workspace_dir TEXT,
  created_at DATETIME,
  updated_at DATETIME
);

CREATE TABLE blocks (
  block_id TEXT PRIMARY KEY,
  thread_id TEXT,
  parent_block_id TEXT,
  sender TEXT,
  type TEXT,
  content TEXT,
  tool_name TEXT,
  tool_input TEXT,  -- JSON
  tool_output TEXT, -- JSON
  status TEXT,
  created_at DATETIME,
  FOREIGN KEY (thread_id) REFERENCES threads(thread_id)
);
```

### 2.3 CLI äº¤äº’

```bash
# å¯åŠ¨æœ¬åœ° Agentï¼ˆäº¤äº’æ¨¡å¼ï¼‰
$ openclaw chat

# æŒ‡å®šå·¥ä½œç›®å½•
$ openclaw chat --workspace ~/projects/myapp

# ç»§ç»­ä¹‹å‰çš„ Thread
$ openclaw chat --thread thread_abc123

# åˆ—å‡ºå†å² Thread
$ openclaw threads list

# æŸ¥çœ‹ Thread è¯¦æƒ…
$ openclaw threads show thread_abc123

# å¯¼å…¥ xiaobei é…ç½®
$ openclaw config import ~/xiaobei-config.json

# æŸ¥çœ‹å½“å‰é…ç½®
$ openclaw config show
```

### 2.4 äº¤äº’ç¤ºä¾‹

```
$ openclaw chat --workspace ~/projects/myapp

ğŸ¤– å°åŒ—æœ¬åœ°ç‰ˆ (Powered by Openclaw)
ğŸ“ å·¥ä½œç›®å½•: /Users/xxx/projects/myapp
ğŸ“ Thread: thread_1706947200 (æ–°å»º)

ä½ : å¸®æˆ‘çœ‹çœ‹è¿™ä¸ªé¡¹ç›®çš„ package.json

ğŸ”§ è°ƒç”¨å·¥å…·: file_read
   è·¯å¾„: /Users/xxx/projects/myapp/package.json

ğŸ“„ æ–‡ä»¶å†…å®¹:
{
  "name": "myapp",
  "version": "1.0.0",
  "dependencies": {
    "express": "^4.18.0"
  }
}

ğŸ¤– è¿™æ˜¯ä¸€ä¸ª Node.js é¡¹ç›®ï¼Œä½¿ç”¨ Express æ¡†æ¶ã€‚éœ€è¦æˆ‘å¸®ä½ åšä»€ä¹ˆï¼Ÿ

ä½ : ç”¨ VSCode æ‰“å¼€è¿™ä¸ªæ–‡ä»¶

ğŸ”§ è°ƒç”¨å·¥å…·: shell_exec
   å‘½ä»¤: code /Users/xxx/projects/myapp/package.json

âœ… å·²ç”¨ VSCode æ‰“å¼€æ–‡ä»¶

ä½ : å¸®æˆ‘å®‰è£… lodash

ğŸ”§ è°ƒç”¨å·¥å…·: shell_exec
   å‘½ä»¤: npm install lodash
   å·¥ä½œç›®å½•: /Users/xxx/projects/myapp

ğŸ“¦ å®‰è£…ä¸­...
added 1 package in 2s

âœ… lodash å·²å®‰è£…
```

---

## 3. æ–‡ä»¶æ“ä½œç­–ç•¥

### 3.1 æ ¸å¿ƒæ€æƒ³ï¼šæœ¬åœ° Agent åª"åè°ƒ"ï¼Œä¸"ä»£æ›¿"

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ–‡ä»¶æ“ä½œç­–ç•¥                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ã€è¯»å–æ–‡ä»¶ã€‘â†’ Agent ç›´æ¥è¯»å–ï¼Œå±•ç¤ºç»™ç”¨æˆ·                         â”‚
â”‚                                                                 â”‚
â”‚  ã€ç®€å•ä¿®æ”¹ã€‘â†’ Agent å¯ä»¥ç›´æ¥ä¿®æ”¹ï¼ˆshell_exec æˆ– file_writeï¼‰     â”‚
â”‚                                                                 â”‚
â”‚  ã€å¤æ‚ç¼–è¾‘ã€‘â†’ Agent æ‰“å¼€ VSCodeï¼Œè®©ç”¨æˆ·è‡ªå·±æ”¹                    â”‚
â”‚              $ code /path/to/file.ts                            â”‚
â”‚                                                                 â”‚
â”‚  ã€ä»£ç ç”Ÿæˆã€‘â†’ Agent ç”Ÿæˆä»£ç ï¼Œè¯¢é—®ç”¨æˆ·æ˜¯å¦å†™å…¥                    â”‚
â”‚              "æˆ‘ç”Ÿæˆäº†ä»¥ä¸‹ä»£ç ï¼Œæ˜¯å¦å†™å…¥ xxx.tsï¼Ÿ"                â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 å·¥å…·å®šä¹‰

```typescript
// æ‰“å¼€ VSCode å·¥å…·
const openVSCodeTool = {
  name: "open_vscode",
  description: "ç”¨ VSCode æ‰“å¼€æ–‡ä»¶æˆ–ç›®å½•ï¼Œè®©ç”¨æˆ·è‡ªå·±ç¼–è¾‘",
  parameters: {
    path: { type: "string", description: "æ–‡ä»¶æˆ–ç›®å½•è·¯å¾„" },
    goto_line: { type: "number", optional: true, description: "è·³è½¬åˆ°æŒ‡å®šè¡Œ" },
  },
  execute: async ({ path, goto_line }) => {
    const cmd = goto_line 
      ? `code --goto "${path}:${goto_line}"`
      : `code "${path}"`;
    await execShell(cmd);
    return { success: true, message: `å·²ç”¨ VSCode æ‰“å¼€: ${path}` };
  },
};

// åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œå‘½ä»¤å·¥å…·
const runInTerminalTool = {
  name: "run_in_terminal",
  description: "åœ¨æ–°ç»ˆç«¯çª—å£ä¸­æ‰§è¡Œå‘½ä»¤ï¼ˆç”¨æˆ·å¯ä»¥çœ‹åˆ°å¹¶äº¤äº’ï¼‰",
  parameters: {
    command: { type: "string", description: "è¦æ‰§è¡Œçš„å‘½ä»¤" },
    work_dir: { type: "string", optional: true, description: "å·¥ä½œç›®å½•" },
  },
  execute: async ({ command, work_dir }) => {
    // macOS: æ‰“å¼€æ–°ç»ˆç«¯çª—å£
    const script = `
      tell application "Terminal"
        activate
        do script "cd ${work_dir || '.'} && ${command}"
      end tell
    `;
    await execShell(`osascript -e '${script}'`);
    return { success: true, message: `å·²åœ¨æ–°ç»ˆç«¯æ‰§è¡Œ: ${command}` };
  },
};
```

---

## 4. ä¸ north-deer-flow å¯¹æ¥

### 4.1 ä¸¤ç§æ–¹å¼

```
æ–¹å¼ A: Openclaw å†…ç½®ç ”ç©¶èƒ½åŠ›ï¼ˆç‹¬ç«‹ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Openclaw æœ¬åœ°å¼•æ“   â”‚
â”‚                     â”‚
â”‚  deep_research å·¥å…· â”‚ â”€â–º ç›´æ¥è°ƒç”¨æœç´¢ APIï¼ˆTavily/Braveï¼‰
â”‚  arxiv_search å·¥å…·  â”‚ â”€â–º ç›´æ¥è°ƒç”¨ Arxiv API
â”‚  report_writer å·¥å…· â”‚ â”€â–º AI ç”ŸæˆæŠ¥å‘Š
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


æ–¹å¼ B: è°ƒç”¨ north-deer-flow APIï¼ˆå¤ç”¨ï¼‰
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Openclaw æœ¬åœ°å¼•æ“   â”‚       â”‚  north-deer-flow    â”‚
â”‚                     â”‚       â”‚  (ç‹¬ç«‹è¿è¡Œ)         â”‚
â”‚  research å·¥å…·      â”‚â”€â”€â”€â”€â”€â”€â–ºâ”‚  /api/research      â”‚
â”‚                     â”‚ HTTP  â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 æ¨èï¼šæ–¹å¼ Aï¼ˆç‹¬ç«‹ï¼‰

å› ä¸ºè¦åš**æœ¬åœ°å®¢æˆ·ç«¯**ï¼Œå°½é‡å‡å°‘å¤–éƒ¨ä¾èµ–ã€‚æŠŠç ”ç©¶èƒ½åŠ›ä¹Ÿé›†æˆåˆ° Openclaw ä¸­ã€‚

```typescript
// æ·±åº¦ç ”ç©¶å·¥å…·ï¼ˆæœ¬åœ°ç‰ˆï¼‰
const deepResearchTool = {
  name: "deep_research",
  description: "å¯åŠ¨æ·±åº¦ç ”ç©¶ï¼Œæœç´¢ç½‘ç»œã€è®ºæ–‡ï¼Œç”ŸæˆæŠ¥å‘Š",
  parameters: {
    topic: { type: "string", description: "ç ”ç©¶ä¸»é¢˜" },
    depth: { type: "string", enum: ["quick", "medium", "deep"] },
  },
  execute: async ({ topic, depth }) => {
    // 1. è°ƒç”¨ web_search æœç´¢ç½‘ç»œ
    const webResults = await tools.web_search({ query: topic });
    
    // 2. è°ƒç”¨ arxiv_search æœç´¢è®ºæ–‡ï¼ˆå¦‚æœ depth >= mediumï¼‰
    let arxivResults = [];
    if (depth !== "quick") {
      arxivResults = await tools.arxiv_search({ query: topic });
    }
    
    // 3. AI åˆ†æå’Œç”ŸæˆæŠ¥å‘Š
    const report = await generateReport(topic, webResults, arxivResults);
    
    return { report, sources: [...webResults, ...arxivResults] };
  },
};
```

---

## 5. æ•´åˆåçš„ç»„ä»¶å¯¹ç…§

### 5.1 ä¸å†éœ€è¦çš„

| åŸç»„ä»¶ | åŸä½œç”¨ | å¤„ç†æ–¹å¼ |
|-------|-------|---------|
| north-app-core | ä»»åŠ¡è°ƒåº¦ã€API ç½‘å…³ã€æ•°æ®åº“ | âŒ ä¸éœ€è¦ï¼ˆæœ¬åœ° SQLite æ›¿ä»£ï¼‰ |
| northau-xiaobei | Agent æ‰§è¡Œå¼•æ“ | âŒ ä¸éœ€è¦ï¼ˆOpenclaw Agent æ›¿ä»£ï¼‰ |
| E2B æ²™ç®± | äº‘ç«¯ä»£ç æ‰§è¡Œ | âŒ ä¸éœ€è¦ï¼ˆæœ¬åœ°æ‰§è¡Œæ›¿ä»£ï¼‰ |
| ç½‘é¡µå‰ç«¯ | Web UI | âŒ ä¸éœ€è¦ï¼ˆCLI + VSCode æ›¿ä»£ï¼‰ |

### 5.2 ä¿ç•™/å¤ç”¨çš„

| ç»„ä»¶ | å¤ç”¨å†…å®¹ |
|-----|---------|
| xiaobei é…ç½®æ ¼å¼ | MAIN_AGENTã€BASE_INFO ç­‰é…ç½®ç»“æ„ |
| Thread/Block ç»“æ„ | æ•°æ®æ¨¡å‹å®šä¹‰ï¼ˆç®€åŒ–ä¸ºæœ¬åœ° SQLiteï¼‰ |
| å·¥å…·å®šä¹‰ | é£ä¹¦ã€æœç´¢ç­‰å·¥å…·çš„é€»è¾‘ï¼ˆç§»æ¤åˆ° TypeScriptï¼‰ |
| north-deer-flow | å¯é€‰å¯¹æ¥ï¼ˆæˆ–ç›´æ¥åœ¨æœ¬åœ°å®ç°ç ”ç©¶èƒ½åŠ›ï¼‰ |

### 5.3 Openclaw æä¾›çš„

| èƒ½åŠ› | è¯´æ˜ |
|-----|------|
| æœ¬åœ°æ–‡ä»¶æ“ä½œ | file_read, file_write, file_edit |
| æœ¬åœ°å‘½ä»¤æ‰§è¡Œ | shell_exec |
| æµè§ˆå™¨è‡ªåŠ¨åŒ– | browser_* |
| Git æ“ä½œ | git_* |
| å¤šæ¨¡å‹æ”¯æŒ | Claude, GPT, Gemini |
| CLI äº¤äº’ | å‘½ä»¤è¡Œç•Œé¢ |

---

## 6. å®æ–½è®¡åˆ’

### 6.1 é˜¶æ®µåˆ’åˆ†

```
é˜¶æ®µ 1: é…ç½®å…¼å®¹ (2å¤©)
â”œâ”€â”€ å®ç° xiaobei é…ç½®æ ¼å¼è§£æ
â”œâ”€â”€ å®ç° config import å‘½ä»¤
â””â”€â”€ æµ‹è¯•æ¨¡å‹è°ƒç”¨

é˜¶æ®µ 2: Thread æœ¬åœ°å­˜å‚¨ (3å¤©)
â”œâ”€â”€ è®¾è®¡ SQLite è¡¨ç»“æ„
â”œâ”€â”€ å®ç° Thread CRUD
â”œâ”€â”€ å®ç° Block CRUD
â””â”€â”€ å®ç° threads list/show å‘½ä»¤

é˜¶æ®µ 3: CLI äº¤äº’å¢å¼º (2å¤©)
â”œâ”€â”€ å®ç° chat å‘½ä»¤ï¼ˆäº¤äº’æ¨¡å¼ï¼‰
â”œâ”€â”€ å®ç° --workspace å‚æ•°
â”œâ”€â”€ å®ç° --thread å‚æ•°ï¼ˆç»§ç»­å¯¹è¯ï¼‰
â””â”€â”€ æµå¼è¾“å‡ºä¼˜åŒ–

é˜¶æ®µ 4: VSCode é›†æˆ (1å¤©)
â”œâ”€â”€ å®ç° open_vscode å·¥å…·
â”œâ”€â”€ å®ç° run_in_terminal å·¥å…·
â””â”€â”€ æµ‹è¯•æ–‡ä»¶ç¼–è¾‘å·¥ä½œæµ

é˜¶æ®µ 5: å°åŒ—å·¥å…·ç§»æ¤ (3å¤©)
â”œâ”€â”€ ç§»æ¤é£ä¹¦å·¥å…·
â”œâ”€â”€ ç§»æ¤æœç´¢å·¥å…·
â”œâ”€â”€ ç§»æ¤æ·±åº¦ç ”ç©¶å·¥å…·
â””â”€â”€ æµ‹è¯•

é˜¶æ®µ 6: æµ‹è¯•ä¼˜åŒ– (2å¤©)
â”œâ”€â”€ ç«¯åˆ°ç«¯æµ‹è¯•
â”œâ”€â”€ æ€§èƒ½ä¼˜åŒ–
â””â”€â”€ æ–‡æ¡£
```

### 6.2 æ—¶é—´ä¼°è®¡

| é˜¶æ®µ | å†…å®¹ | æ—¶é—´ |
|-----|------|------|
| 1 | é…ç½®å…¼å®¹ | 2å¤© |
| 2 | Thread æœ¬åœ°å­˜å‚¨ | 3å¤© |
| 3 | CLI äº¤äº’å¢å¼º | 2å¤© |
| 4 | VSCode é›†æˆ | 1å¤© |
| 5 | å°åŒ—å·¥å…·ç§»æ¤ | 3å¤© |
| 6 | æµ‹è¯•ä¼˜åŒ– | 2å¤© |
| **æ€»è®¡** | | **~13å¤©** |

---

## 7. é…ç½®æ–‡ä»¶ç¤ºä¾‹

### 7.1 æœ¬åœ°é…ç½® (~/.openclaw/config.json)

```json5
{
  // å°åŒ—é…ç½®æ ¼å¼å…¼å®¹
  "xiaobei": {
    "BASE_INFO": {
      "tenant_id": "local",
      "user_id": "local_user",
      "user_name": "æœ¬åœ°ç”¨æˆ·"
    },
    "MAIN_AGENT": {
      "base_url": "https://api.anthropic.com",
      "api_key": "${ANTHROPIC_API_KEY}",
      "model": "claude-sonnet-4"
    }
  },
  
  // Openclaw ç‰¹æœ‰é…ç½®
  "workspace": {
    "default_dir": "/Users/xxx/projects"
  },
  
  // Thread å­˜å‚¨
  "storage": {
    "type": "sqlite",
    "path": "~/.openclaw/threads.db"
  },
  
  // å·¥å…·é…ç½®
  "tools": {
    "feishu": {
      "app_id": "${FEISHU_APP_ID}",
      "app_secret": "${FEISHU_APP_SECRET}"
    },
    "search": {
      "provider": "tavily",
      "api_key": "${TAVILY_API_KEY}"
    }
  },
  
  // å®‰å…¨é…ç½®
  "security": {
    "allowed_directories": [
      "/Users/xxx/projects",
      "/Users/xxx/workspace"
    ]
  }
}
```

### 7.2 ç¯å¢ƒå˜é‡ (.env)

```bash
# API Keys
ANTHROPIC_API_KEY=sk-ant-xxx
OPENAI_API_KEY=sk-xxx

# é£ä¹¦
FEISHU_APP_ID=cli_xxx
FEISHU_APP_SECRET=xxx

# æœç´¢
TAVILY_API_KEY=tvly-xxx
```

---

## 8. ä½¿ç”¨ç¤ºä¾‹

### 8.1 é¦–æ¬¡é…ç½®

```bash
# æ–¹å¼ 1: äº¤äº’å¼é…ç½®
$ openclaw init
? é€‰æ‹© AI æ¨¡å‹: Claude Sonnet 4
? è¾“å…¥ API Key: sk-ant-xxx
? é»˜è®¤å·¥ä½œç›®å½•: /Users/xxx/projects
âœ… é…ç½®å·²ä¿å­˜åˆ° ~/.openclaw/config.json

# æ–¹å¼ 2: å¯¼å…¥ xiaobei é…ç½®
$ openclaw config import ./xiaobei-config.json
âœ… é…ç½®å·²å¯¼å…¥
```

### 8.2 æ—¥å¸¸ä½¿ç”¨

```bash
# å¯åŠ¨èŠå¤©ï¼ˆæ–° Threadï¼‰
$ openclaw chat
ğŸ¤– å°åŒ—æœ¬åœ°ç‰ˆå·²å¯åŠ¨
ğŸ“ å·¥ä½œç›®å½•: /Users/xxx/projects
ä½ : _

# æŒ‡å®šé¡¹ç›®ç›®å½•
$ openclaw chat -w ~/projects/myapp
ğŸ“ å·¥ä½œç›®å½•: /Users/xxx/projects/myapp
ä½ : _

# ç»§ç»­ä¹‹å‰çš„å¯¹è¯
$ openclaw threads list
  thread_001  2024-02-03 10:00  "å¸®æˆ‘åˆ†æé¡¹ç›®ç»“æ„"
  thread_002  2024-02-03 11:30  "npm install é—®é¢˜"
* thread_003  2024-02-03 14:00  "å½“å‰" (active)

$ openclaw chat --thread thread_001
ğŸ“ ç»§ç»­ Thread: thread_001
ä½ : _

# æŸ¥çœ‹å¯¹è¯å†å²
$ openclaw threads show thread_001
```

### 8.3 å®é™…å¯¹è¯

```
$ openclaw chat -w ~/projects/myapp

ä½ : è¿™ä¸ªé¡¹ç›®æ˜¯ä»€ä¹ˆæ¡†æ¶ï¼Ÿ

ğŸ”§ file_read: package.json
ğŸ”§ file_read: tsconfig.json

ğŸ¤– è¿™æ˜¯ä¸€ä¸ª TypeScript + Express é¡¹ç›®ã€‚
   - ä½¿ç”¨ Express 4.18 ä½œä¸º Web æ¡†æ¶
   - TypeScript 5.0
   - åŒ…å« Jest æµ‹è¯•æ¡†æ¶

ä½ : å¸®æˆ‘ç”¨ VSCode æ‰“å¼€ src ç›®å½•

ğŸ”§ open_vscode: /Users/xxx/projects/myapp/src

âœ… å·²ç”¨ VSCode æ‰“å¼€ src ç›®å½•

ä½ : è¿è¡Œæµ‹è¯•

ğŸ”§ shell_exec: npm test

ğŸ“¦ Running tests...
 PASS  src/__tests__/app.test.ts
 âœ“ should return hello (5ms)
 
All tests passed!

ä½ : æœç´¢ä¸€ä¸‹ Express æœ€ä½³å®è·µ

ğŸ”§ web_search: "Express.js best practices 2024"

ğŸ” æœç´¢ç»“æœ:
1. Express.js Best Practices - expressjs.com
2. 10 Best Practices for Express Apps - blog.xxx
3. ...

ğŸ¤– æ ¹æ®æœç´¢ç»“æœï¼Œä»¥ä¸‹æ˜¯ Express æœ€ä½³å®è·µï¼š
1. ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†é…ç½®
2. å®ç°é”™è¯¯å¤„ç†ä¸­é—´ä»¶
3. ...
```

---

## 9. æ€»ç»“

### 9.1 æœ€ç»ˆæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æœ¬åœ°å®¢æˆ·ç«¯æ¶æ„                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚   ç”¨æˆ· â†â”€â”€â–º CLI (openclaw chat)                          â”‚
â”‚              â”‚                                            â”‚
â”‚              â–¼                                            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚         Openclaw æœ¬åœ°å¼•æ“                        â”‚    â”‚
â”‚   â”‚                                                  â”‚    â”‚
â”‚   â”‚   é…ç½®å±‚ï¼šxiaobei é…ç½®æ ¼å¼å…¼å®¹                    â”‚    â”‚
â”‚   â”‚   å­˜å‚¨å±‚ï¼šæœ¬åœ° SQLite (Thread/Block)             â”‚    â”‚
â”‚   â”‚   Agentå±‚ï¼šAI æ¨¡å‹è°ƒç”¨ + å·¥å…·åè°ƒ                â”‚    â”‚
â”‚   â”‚   å·¥å…·å±‚ï¼šæœ¬åœ°æ‰§è¡Œ + å°åŒ—å·¥å…·                    â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚              â”‚                                            â”‚
â”‚              â–¼                                            â”‚
â”‚   æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ + VSCode + ç»ˆç«¯                            â”‚
â”‚                                                           â”‚
â”‚   ä¸éœ€è¦:                                                 â”‚
â”‚   âŒ north-app-core                                       â”‚
â”‚   âŒ northau-xiaobei                                      â”‚
â”‚   âŒ E2B æ²™ç®±                                             â”‚
â”‚   âŒ ç½‘é¡µå‰ç«¯                                             â”‚
â”‚                                                           â”‚
â”‚   å¯é€‰å¯¹æ¥:                                               â”‚
â”‚   âšª north-deer-flow (å¦‚éœ€è¦ï¼Œæˆ–ç›´æ¥å†…ç½®)                 â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 æ ¸å¿ƒä»·å€¼

| æ–¹é¢ | è¯´æ˜ |
|-----|------|
| **ç®€åŒ–** | 4ä¸ªæœåŠ¡ â†’ 1ä¸ªæœ¬åœ°å¼•æ“ |
| **æœ¬åœ°** | ç›´æ¥æ“ä½œæœ¬åœ°æ–‡ä»¶ã€æ‰§è¡Œå‘½ä»¤ |
| **å…¼å®¹** | å¤ç”¨ xiaobei çš„é…ç½®æ ¼å¼ |
| **çµæ´»** | æ–‡ä»¶ç¼–è¾‘ç”¨ VSCodeï¼Œç»ˆç«¯ç”¨ç³»ç»Ÿç»ˆç«¯ |
| **è½»é‡** | æœ¬åœ° SQLite å­˜å‚¨ï¼Œæ— éœ€æ•°æ®åº“æœåŠ¡ |

---

*æ–‡æ¡£ç»“æŸ*
