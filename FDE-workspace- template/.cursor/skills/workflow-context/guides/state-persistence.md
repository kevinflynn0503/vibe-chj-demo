# 状态持久化详解

## 三文件模式

### task_plan.md

跟踪工作流的整体进度。是所有操作的锚点。

**更新时机**: 每个阶段完成后立即更新。

**核心规则**:
1. 永远不要在没有 task_plan.md 的情况下开始复杂任务
2. 每次重大决策前，先阅读 task_plan.md
3. 完成阶段后立即标记 [x]
4. 记录所有遇到的错误

### notes.md

存储研究发现、中间分析、方案对比。

**更新时机**: 研究过程中随时写入。

**核心规则**:
1. 大量信息存到 notes.md，不要塞满上下文窗口
2. 按主题分节，方便后续查找
3. 记录来源和参考链接

### deliverable.md

最终交付物的索引文件。

**更新时机**: 工作流完成时。

**内容**: 文档产出列表、代码路径、部署信息、后续建议。

---

## 循环模式

```
循环 1: 创建 task_plan.md（目标和阶段）
循环 2: 研究 -> 保存到 notes.md -> 更新 task_plan.md
循环 3: 阅读 notes.md -> 创建交付物 -> 更新 task_plan.md
循环 4: 交付最终输出 -> 更新 deliverable.md
```

---

## 文件位置

标准位置: `{PROJECT_ROOT}/.claudedocs/`

Git Worktree 位置: `{WORKTREE_PATH}/.claudedocs/`
