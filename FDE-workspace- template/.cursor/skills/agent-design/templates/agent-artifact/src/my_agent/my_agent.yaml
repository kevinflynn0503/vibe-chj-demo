# =====================================================
# My Agent 配置
# =====================================================

name: my_agent

# 变量定义
variables:
  max_tokens: 200000

# 基本配置
max_iterations: 100000
max_context_tokens: 600000
max_running_subagents: 10

# System Prompt
system_prompt: my_agent.md
system_prompt_type: jinja

# LLM 配置
llm_config:
  temperature: 0.6
  max_tokens: 35000
  stream: true
  timeout: 600

# 工具列表
tools:
  # 任务管理
  - name: TodoWrite
    yaml_path: ../../../../tools/base/src/my_tool_base/todo/tool.yaml
    binding: my_tool_base:todo_write
    
  # 搜索
  - name: Search
    yaml_path: ../../../../tools/search/src/my_tool_search/search/tool.yaml
    binding: my_tool_search:search
    
  # 文件操作
  - name: Read
    yaml_path: ../../../../tools/filesystem/src/my_tool_filesystem/read/tool.yaml
    binding: my_tool_filesystem:read
  - name: Write
    yaml_path: ../../../../tools/filesystem/src/my_tool_filesystem/write/tool.yaml
    binding: my_tool_filesystem:write
  - name: Edit
    yaml_path: ../../../../tools/filesystem/src/my_tool_filesystem/edit/tool.yaml
    binding: my_tool_filesystem:edit
  - name: LS
    yaml_path: ../../../../tools/filesystem/src/my_tool_filesystem/ls/tool.yaml
    binding: my_tool_filesystem:ls
    
  # 完成工具
  - name: Finish
    yaml_path: ../../../../tools/base/src/my_tool_base/finish/tool.yaml
    binding: my_tool_base:finish

# 子代理
sub_agents:
  - name: HelperAgent
    config_path: ./sub_agents/helper/helper.yaml

# MCP 服务器（可选）
# mcp_servers:
#   - name: external-api
#     type: http
#     url: https://api.example.com/mcp

# 中间件
middlewares:
  # 日志
  - import: nexau.archs.main_sub.execution.hooks:LoggingMiddleware
    params:
      model_logger: "[my_agent][model_debug]"
      tool_logger: "[my_agent][tool_debug]"
      log_model_calls: true
      
  # 上下文压缩
  - import: nexau.archs.main_sub.execution.middleware.context_compaction:ContextCompactionMiddleware
    params:
      max_context_tokens: ${variables.max_tokens}
      auto_compact: true
      threshold: 0.75
      compaction_strategy: "sliding_window"
      window_size: 2

# 停止工具
stop_tools: [Finish]
