# 错误恢复

## 错误类型

| 错误类型 | 说明 | 恢复方式 |
|---------|------|---------|
| 阶段执行失败 | 技能执行中出错 | 重试 / 跳过 / 回退 |
| 检查点超时 | 用户未响应 | 暂停等待 |
| 产出验证失败 | 输出不符合要求 | 重新执行 |
| 依赖缺失 | 前期文件不存在 | 回到缺失阶段 |
| 用户终止 | 主动停止 | 保存状态后退出 |

## 恢复流程

```
错误发生
  |
  v
记录到 task_plan.md 的"遇到的错误"章节
  |
  v
更新状态为 paused
  |
  v
提供选项:
  - 重试当前阶段
  - 跳过当前阶段
  - 返回上一阶段
  - 终止工作流
```

## 会话恢复

新会话开始时自动检测:

```
检查 .claudedocs/task_plan.md 是否存在
  |
  存在 -> 读取当前阶段和进度 -> 询问用户是否继续
  |
  不存在 -> 从头开始
```

## 错误记录格式

```markdown
## 遇到的错误
- [Phase 3] TypeScript 编译失败: 缺少类型定义 -> 安装 @types/xxx 解决
- [Phase 4] Supabase 连接超时 -> 检查环境变量配置
```
