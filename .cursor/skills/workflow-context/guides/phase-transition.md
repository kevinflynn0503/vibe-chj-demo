# 阶段转换规则

## 转换流程

```
阶段完成
  |
  v
验证产出 -> 保存产出文件
  |
  v
有检查点? --是--> 等待用户确认
  |                  |
  否            批准/修改/重做/终止
  |                  |
  v                  v
更新进度 --> 加载下一阶段输入 --> 开始下一阶段
```

## 阶段定义

每个阶段包含:
- **id**: 阶段标识（phase-0 ~ phase-6）
- **skill**: 使用的技能
- **inputs**: 需要读取的前期文件
- **outputs**: 本阶段产出文件
- **checkpoint**: 是否有检查点

## 检查点配置

默认检查点:
- Phase 1 (PRD): 必须确认
- Phase 3 (架构): 必须确认
- Phase 6 (最终): 必须确认

自动模式下所有检查点被跳过。

## 上下文加载

进入新阶段时，按以下顺序加载:
1. 读取 task_plan.md（当前状态）
2. 读取本阶段所需的所有 inputs 文件
3. 读取 notes.md 中相关章节
4. 开始执行
