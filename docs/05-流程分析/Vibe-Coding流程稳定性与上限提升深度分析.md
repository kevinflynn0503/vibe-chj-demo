# Vibe Coding 流程稳定性与上限提升——深度分析

> 日期：2026-02-11  
> 范围：基于漕河泾驾驶舱（vibe-chj-demo）完整开发过程的复盘  
> 目标：提炼可复用的方法论，提高 Vibe Coding 流程的**下限稳定性**和**上限天花板**

---

## 〇、文档定位

本文档不是"漕河泾项目"的分析，而是站在 **Vibe Coding 方法论** 的高度，以漕河泾项目作为实验样本，系统复盘人机协作中暴露出来的所有问题模式，并给出可工程化落地的改进方案。

核心问题：**为什么 AI 能写出功能正确的代码，却反复产出"看起来不对"的产品？如何让流程稳定收敛，而不是反复发散-推翻？**

---

## 一、项目全过程回溯：30+ 轮 Prompt 的演化图谱

### 1.1 Prompt 时间线与分类

以下是项目开发过程中 FDE 给出的所有关键指令（prompt），按时间顺序排列，并标注每条指令的本质诉求类型：

| 轮次 | Prompt 摘要 | 本质类型 | 是否首次提出 |
|------|------------|---------|-------------|
| 1 | "页面太素了，增加些元素，主题色" + "不要太花里胡哨！不要AI廉价设计感" | 🎨 视觉调性 | ✅ |
| 2 | "放到iframe中顶部导航栏很奇怪" + "灰色背景改白色" | 🏗 架构适配 | ✅ |
| 3 | "政策服务页面mock数据没了" + "为什么还有AI筛选结果" + "企业详情页报错" | 🐛 回归Bug | ✅ |
| 4 | "不需要单独触达任务列表" + "管理看板不是管理AI的" + "企业详情内容太少" | 📋 需求理解偏差 | ✅ |
| 5 | "首页如何修改" + "触达二级页面没改" + "分配逻辑应该在管理版" | 📋 需求遗漏 + 角色混淆 | ❌ 重复 |
| 6 | "政策二级页面没结合AI" + "孵化器操作太多布局没优化" + "企业库需要优化结合AI" | 🤖 AI能力未展示 | ✅ |
| 7 | "政策和孵化器比较乱" + "需求场景都清晰了吗" | 📋 业务逻辑不清晰 | ❌ 重复 |
| 8 | "客户拜访需要改吗" | ❓ 需求边界不清 | ✅ |
| 9 | "政策服务和孵化器差些意思" + "很多是数据看板给老板看的" | 👥 角色分离 | ✅ |
| 10 | "走访任务应该一键生成" + "跟进阶段应该看结果" + "很多地方可以提供AI分析按钮" | 🤖 HITL流程缺失 | ✅ |
| 11 | "你的设计合理吗" + "有更好的方案吗" | 🔍 方案质疑 | ✅ |
| 12 | "哪些是人做的AI做不了的" + "如何配合通过页面展示" | 🤖 人机边界 | ❌ 深化 |
| 13 | "老板和员工工作混在一起" + "都是人手动操作实际上要AI完成" | 👥 角色+HITL | ❌ 重复 |
| 14 | "顶部右侧有空白" + "待办交互混在一起" + "需求都满足了吗" | 🎨 视觉 + 📋 需求 | ❌ 混合 |
| 15 | "页面框架返回按钮不一致" + "有没有skill统一" | 🏗 一致性 | ✅ |
| 16 | "客户拜访内容宽度不一样" + "孵化器企业不应打开企业库" | 🏗 一致性 + 📋 逻辑 | ❌ 重复 |
| 17 | "UI规范布局不统一" + "政策和孵化器布局太奇怪" + "和需求离得很远" | 🏗+📋 全面质疑 | ❌ 反复 |
| 18 | "走访看板优化参考飞书" + "企业库用卡片" + "嵌入小北预览" + "适配移动端" | 🎨+🏗 多维优化 | 部分新 |
| 19 | "企业库冲着企查查做" + "风格不统一" + "不要蓝紫渐变" | 🎨 视觉标杆 | ❌ 重申 |
| 20 | "企业画像是画像，走访流程是流程" | 📋 概念区分 | ✅ |
| 21 | "企业画像库tab为什么和左边不放一起" + "首页怎么进" | 🏗 导航逻辑 | ❌ 重复 |
| 22 | "AI感有些重，大色块描边白色卡片阴影" | 🎨 视觉过度 | ✅ |
| 23 | "企业数据库不是单独拆出来？" + "页面没改" + "都改完了吗" | 🐛 执行遗漏 | ❌ 重复 |
| 24 | "企业画像单独拆" + "梳理用户流程" + "很多数据没展示" | 📋+📊 信息密度 | ❌ 深化 |
| 25 | "UI不需要深色模式" + "颜色不符合中国用户" + "参考飞书" + "功能页面都是展示不是操作" | 🎨+📋 方向偏离 | ✅ 质变 |
| 26 | "功能和看板分开" + "UI太丑太简单" + "参考ui-ux-pro-max skill" | 🎨+🏗 架构重组 | ✅ |
| 27 | "看不出来怎么用" + "复杂跳转逻辑" + "模拟浏览器标签页" | 🏗 导航重构 | ❌ 重复 |
| 28 | "切换导航栏会动来动去" + "卡片点进去内容丢了" + "布局不统一缺少骨架loading" | 🐛+🏗 回归+一致性 | ✅ 关键 |

### 1.2 问题分类统计

| 类型 | 代号 | 出现次数 | 重复率 | 说明 |
|------|------|---------|--------|------|
| 需求理解偏差 | 📋 | 14 | 64% | 需求被反复纠正，核心是AI没有真正理解业务 |
| 视觉/UI调性 | 🎨 | 10 | 50% | 审美收敛极慢，FDE和AI对"好看"没有对齐 |
| 架构/一致性 | 🏗 | 9 | 67% | 布局不统一是贯穿始终的顽疾 |
| AI能力展示 | 🤖 | 5 | 40% | AI产品中看不到AI——讽刺 |
| 回归Bug | 🐛 | 4 | 75% | 改A坏B，数据丢失 |
| 角色分离 | 👥 | 3 | 67% | 老板和员工视角混淆 |

**关键发现：64% 的需求反馈是重复提出的**。这意味着 AI 在第一次收到反馈后并没有真正修正到位，导致 FDE 不断重复相同的诉求。

---

## 二、六大核心问题的根因分析

### 2.1 问题一：需求理解的"表面执行"陷阱

**现象**：AI 每次都"改了"，但 FDE 每次都说"还是不对"。

**根因**：AI 执行的是 prompt 的字面意思，而不是 prompt 背后的业务意图。

```
FDE 说："政策服务和孵化器比较乱"
                    ↓
AI 理解为："调整一下布局顺序"
                    ↓
实际意思是："用户进来不知道第一步做什么，业务流程没有被UI表达出来"
```

**本质**：AI 缺乏"从用户旅程出发设计页面"的能力。它在执行"功能堆砌"而不是"流程导航"。

**对比**：

| 维度 | AI 的理解 | FDE 的真实意图 |
|------|----------|--------------|
| "页面太素" | 加颜色、加阴影 | 增加信息密度和视觉层次 |
| "结合AI优化" | 加个AI图标 | 设计AI工作流程：输入→处理→输出 |
| "参考飞书" | 抄飞书配色 | 学飞书的信息架构和交互模式 |
| "内容太少" | 加mock数据字段 | 增加维度、增加图表、增加分析 |
| "布局奇怪" | 换一种CSS布局 | 重新思考信息优先级和用户动线 |

**修正策略**：

1. **建立"意图层"翻译机制**：每收到 FDE 反馈，先输出"我理解你的意思是……"，等确认后再执行
2. **强制业务流程前置**：修改任何页面前，先画出该页面在用户旅程中的位置
3. **禁止"只改样式不改结构"**：如果 FDE 说"布局奇怪"，必须先分析信息架构是否正确

---

### 2.2 问题二：UI 审美的"不可能三角"

**现象**：FDE 反复在"太素"→"太花"→"AI廉价感"→"太素"之间震荡。

**根因**：AI 没有一个稳定的设计系统（Design Token），每次调整都是局部补丁。

```
轮次1: "太素了" → 加渐变、加阴影
轮次5: "AI廉价感" → 去渐变、去阴影  
轮次10: "太简单" → 又加回来一些
轮次15: "还是太花" → 又去掉
```

**本质**：这是一个**收敛缺失**的问题。缺少明确的 Design Token 约束，导致每次调整都是"相对于上一版"的主观判断，而不是"向目标靠拢"的客观收敛。

**对比**：

| 维度 | 当前做法 | 应该做法 |
|------|---------|---------|
| 配色 | 每次手写颜色值 | 定义色板：primary/secondary/neutral |
| 圆角 | 各处不同 6-12px | 统一 token：sm=6/md=8/lg=12 |
| 阴影 | 有/无反复横跳 | 定义层级：level-0=无/level-1=微/level-2=轻 |
| 间距 | 每页手写 | 统一 spacing scale：4/8/12/16/24 |
| 字号 | 各页不一致 | 统一 type scale：xs/sm/base/lg/xl |

**修正策略**：

1. **在项目第一天就锁定 Design Token**：写一个 `design-tokens.md` 文件，所有后续开发必须引用
2. **参考标杆在前，动手在后**：先截图飞书/钉钉的关键页面，标注"我们要学什么"，再写代码
3. **CSS 变量 + Tailwind 配置**：token 不是文档，是代码。写在 `tailwind.config.js` 和 `index.css` 中

---

### 2.3 问题三：架构一致性的"百页面崩塌"

**现象**：每个 Tab 页面的宽度不同、头部风格不同、二级页面返回按钮不一致、切换跳动。

**根因**：缺少**共享布局组件**。每个页面各自手写布局参数，微小差异累积成宏观不一致。

**溯源**：

```
Phase 4: AI 先做首页 → 顺手写了 max-w-[1200px] mx-auto px-4
Phase 4: 再做走访页 → 忘了首页写了什么 → max-w-[1200px] mx-auto px-6
Phase 4: 再做政策页 → 各种实验 → max-w-7xl px-4 sm:px-6 lg:px-8
...
结果: 6个Tab页面有4种不同的宽度约束
```

**本质**：AI 在长上下文中**遗忘了前面的决策**。它没有机制强制后续页面复用前面的布局约定。

**修正策略**（后期已部分执行）：

1. **Layout-First 开发**：第一步不是做页面，是做共享布局组件（`PageContainer`、`DetailHeader`）
2. **CSS Class 代替 Inline Style**：把布局约束抽到 `index.css` 的 `.page-container` class 中
3. **Lint 级约束**：如果有人在页面里写 `max-w-` 而不用 `PageContainer`，应该被拦住
4. **骨架屏统一**：`loading.tsx` 也复用同一套布局，从加载态开始保持一致

---

### 2.4 问题四：AI 产品中 "看不到 AI"

**现象**：FDE 多次反馈 "很多地方可以提供AI分析按钮"、"走访应该一键生成"、"订单匹配应该先展示AI匹配按钮"。

**根因**：AI 在设计页面时，把自己当成了传统 CRUD 应用的开发者。它会做"表格 + 筛选 + 详情"，但不会主动设计"AI 触发 → 等待 → 结果展示"的交互模式。

**本质**：这暴露了一个深层矛盾——**用 AI 来设计 AI 产品，AI 并不天然理解 AI 产品的交互范式**。

**HITL（Human-in-the-Loop）交互的正确模式**：

```
传统应用:  用户操作 → 系统处理 → 结果展示
AI应用:    用户触发 → AI分析（异步） → 中间状态（思考中） → 结果展示 → 人确认/修改 → 执行
```

**每个 AI 功能点应该包含的 UI 元素**：

| 元素 | 作用 | 示例 |
|------|------|------|
| 触发入口 | 用户发起AI任务 | "AI 生成走访准备" 按钮 |
| 进度状态 | 异步处理中的反馈 | "正在分析企业数据…" loading |
| 结果展示 | AI 产出的结构化结果 | 走访提纲、匹配企业列表 |
| 置信度标记 | AI 对结果的把握程度 | 高/中/低匹配度、评分 |
| 人工编辑 | 人修改 AI 结果 | 可编辑的报告字段 |
| 确认执行 | 人审批后触发下游 | "确认并发送" |
| 历史记录 | 同一任务的多次 AI 分析 | 版本对比 |

**修正策略**：

1. **在 App 设计阶段标注"AI 触点"**：每个页面必须标注"此处需要 AI"还是"此处是纯展示"
2. **建立 AI 交互组件库**：`AIActionButton`、`AIResultCard`、`AIConfidenceTag`
3. **Agent 工作流 ↔ UI 映射表**：每个 Agent 的输入/输出都有对应的 UI 组件

---

### 2.5 问题五：角色（Persona）混淆

**现象**：老板看板和员工操作界面混在一起。工作量统计、转化率漏斗等管理视图出现在一线员工的日常工作页面中。

**根因**：需求分析阶段没有做**角色-功能矩阵**。所有功能平铺在同一个层面，没有按角色分视图。

**正确的角色体系**：

```
┌─────────────────────────────────────────────┐
│                 管理者（顾总/蔡总/薛科总）      │
│  看什么: 全局统计、趋势、异常预警、员工绩效     │
│  做什么: 审批、分配、策略调整                   │
│  入口: 独立的"管理看板"Tab                     │
└───────────────────┬─────────────────────────┘
                    │ 只看，不做日常操作
┌───────────────────┴─────────────────────────┐
│                 一线员工（招商经理/项目经理）     │
│  看什么: 我的任务、我的企业、我的待办            │
│  做什么: 走访、触达、填报、跟进                 │
│  入口: 工作台首页 → 各场景Tab                  │
└─────────────────────────────────────────────┘
```

**修正策略**：

1. **需求阶段增加"角色标签"**：每条需求标注`给谁用`（管理者/员工/共用）
2. **页面设计时强制声明 Persona**：每个页面顶部注释 `// Persona: employee | manager | shared`
3. **管理视图物理隔离**：不是"某个Tab里有个管理入口"，而是独立的管理看板模块

---

### 2.6 问题六：回归 Bug 与"改A坏B"

**现象**：改政策页面导致 mock 数据丢失；重构UI导致二级页面内容变空；统一布局导致卡片内容不见了。

**根因**：

1. **AI 每次修改的范围不可控**：一个"优化政策页面"的 prompt 可能导致 AI 重写整个文件，连带改掉了不该改的部分
2. **缺少回归验证环节**：改完后没有检查其他页面是否还正常
3. **Mock 数据与页面耦合**：数据和视图写在一起，改视图容易丢数据

**修正策略**：

1. **原子化 Prompt**：一次只改一个页面/一个组件，明确说"不要改其他文件"
2. **每次改动后跑全站检查**：至少每个 Tab 页面 + 关键二级页面截图对比
3. **数据层与视图层分离**：`mock-data.ts` 独立文件，页面只引用不定义数据
4. **Git 提交粒度控制**：每完成一个功能点就提交，方便回溯

---

## 三、流程稳定性提升方案

### 3.1 当前流程的问题模型

```
┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐
│ FDE指令  │────→│ AI执行   │────→│ FDE审查  │────→│ 发现问题 │──┐
└─────────┘     └─────────┘     └─────────┘     └─────────┘  │
     ↑                                                         │
     └─────────────────────────────────────────────────────────┘
                           无限循环
```

问题：**FDE 的指令是模糊的，AI 的执行是过度自由的，审查是事后的。**

### 3.2 改进后的流程模型

```
┌─────────┐     ┌──────────┐     ┌──────────┐     ┌─────────┐     ┌─────────┐
│ FDE指令  │────→│ AI理解确认│────→│ 方案对齐  │────→│ AI执行   │────→│ 自动验证 │
└─────────┘     └──────────┘     └──────────┘     └─────────┘     └─────────┘
                 "你的意思是…"    "我计划这样改…"    约束执行        回归检查
                                                                      │
                                                                 ┌────┴────┐
                                                                 │ 通过/失败│
                                                                 └─────────┘
```

### 3.3 具体改进措施

#### A. 前置对齐（Before Coding）

| 措施 | 操作 | 预期效果 |
|------|------|---------|
| **意图确认** | AI 收到 prompt 后先输出"我理解你的意思是……具体计划是……" | 减少 60% 的理解偏差 |
| **影响范围声明** | "此次修改涉及 X、Y、Z 三个文件，不动其他页面" | 减少 80% 的回归Bug |
| **设计参考前置** | 先给出参考截图/标杆，标注"学什么"，再写代码 | 减少 50% 的审美震荡 |
| **Checklist 模板** | 每个 prompt 自动附加验证清单 | 减少遗漏 |

#### B. 约束执行（During Coding）

| 措施 | 操作 | 预期效果 |
|------|------|---------|
| **共享组件优先** | 新页面必须用 `PageContainer` + `DetailHeader` | 杜绝布局不一致 |
| **Design Token 强制** | 颜色/圆角/阴影/间距只允许使用 token 变量 | 杜绝视觉不一致 |
| **Persona 标注** | 每个页面必须在文件头声明给谁用 | 杜绝角色混淆 |
| **原子化修改** | 每次 prompt 只改 1-2 个文件，改完提交 | 减少改A坏B |

#### C. 后置验证（After Coding）

| 措施 | 操作 | 预期效果 |
|------|------|---------|
| **全站截图对比** | 改完后自动截图所有页面，和上一版对比 | 发现视觉回归 |
| **布局一致性检测** | 检查所有Tab页面的宽度/间距是否一致 | 发现结构回归 |
| **Mock 数据完整性** | 检查每个页面的数据是否还在 | 发现数据丢失 |
| **路由可达性** | 检查每个路由是否能正常访问 | 发现 404 |

---

## 四、上限提升方案

### 4.1 当前天花板在哪里

| 维度 | 当前能力 | 天花板限制 |
|------|---------|----------|
| **产品设计** | 能做功能堆砌，不能做用户旅程设计 | AI 不理解"用户走进来第一步想做什么" |
| **视觉设计** | 能写CSS，不能做设计系统 | AI 对审美没有稳定的判断标准 |
| **信息架构** | 能做列表-详情，不能做复杂导航 | AI 不理解"信息应该怎么组织才好用" |
| **AI 交互** | 能做按钮-结果，不能做完整工作流 | AI 不理解"AI 应该在什么时候介入" |
| **业务理解** | 能读懂需求文档，不能推断隐含逻辑 | AI 缺乏行业经验 |

### 4.2 突破策略

#### 策略一：引入"设计决策前置"机制

**问题**：AI 在写代码之前没有做设计决策。它直接从 prompt 跳到代码。

**改进**：在 Phase 4（Demo）之前，增加 **Phase 3.5：交互设计稿**。

```
Phase 3: 产品方案设计（文字）
    ↓
Phase 3.5: 交互设计稿（新增）
    - 每个页面的线框图（用文字描述或 ASCII 图）
    - 信息优先级排序
    - 用户动线标注
    - AI 触点标注
    ↓
Phase 4: 静态 Demo（代码）
```

具体操作：在 `docs/03-产品设计/App设计/` 中，每个 App 设计文档必须包含：

```markdown
### 页面 X 的信息层级

1. 核心操作区（顶部）：今日待办 → 一键进入
2. 数据概览区（中部）：3-4 个关键数字
3. 任务列表区（主体）：按状态分组
4. 辅助信息区（底部或侧边）：历史记录、参考资料

### AI 触点

| 位置 | AI 功能 | 触发方式 | 结果展示 |
|------|---------|---------|---------|
| 企业卡片右侧 | AI 画像分析 | 点击"AI 分析"按钮 | 侧边抽屉 |
| 走访任务行内 | AI 生成准备材料 | 点击"生成"按钮 | 内联展开 |
```

#### 策略二：建立 "标杆驱动设计" 模式

**问题**：FDE 说"参考飞书"，AI 只参考了配色，没有参考信息架构。

**改进**：建立标杆参考库，且每次参考都要明确"学什么"。

```markdown
## 标杆参考库

### 飞书工作台
- 学什么：Tab 工作台的信息密度和节奏感
- 不学什么：配色方案（我们用自己的）

### 企查查
- 学什么：企业信息的维度和展示方式
- 不学什么：广告和会员推销

### 钉钉审批
- 学什么：流程可视化（进度条 + 节点状态）
- 不学什么：审批流程（我们是 AI 流程不是审批流程）
```

#### 策略三：Design Token 工程化

**问题**：UI 调性反复震荡，缺少稳定锚点。

**改进**：在项目第一天就建立并锁定 Design Token。

```css
/* index.css — Design Tokens */
:root {
  /* 色板 — 锁定后不轻易修改 */
  --color-primary: #3370FF;          /* 飞书蓝 */
  --color-primary-light: #E8F0FF;    /* 选中背景 */
  --color-text-primary: #1F2329;     /* 正文 */
  --color-text-secondary: #646A73;   /* 辅助文字 */
  --color-text-placeholder: #8F959E; /* 占位 */
  --color-border: #DEE0E3;           /* 分割线 */
  --color-bg-body: #F5F6F7;          /* 页面底色 */
  --color-bg-card: #FFFFFF;          /* 卡片底色 */
  --color-success: #34C759;          /* 成功 */
  --color-warning: #FF9500;          /* 警告 */
  --color-danger: #FF3B30;           /* 危险 */

  /* 圆角 */
  --radius-sm: 6px;
  --radius-md: 8px;
  --radius-lg: 12px;
  --radius-full: 9999px;

  /* 阴影 — 极度克制 */
  --shadow-none: none;
  --shadow-sm: 0 1px 2px rgba(0,0,0,0.04);
  --shadow-md: 0 2px 8px rgba(0,0,0,0.06);

  /* 间距 */
  --space-xs: 4px;
  --space-sm: 8px;
  --space-md: 12px;
  --space-lg: 16px;
  --space-xl: 24px;
  --space-2xl: 32px;

  /* 页面布局 */
  --page-max-width: 1200px;
  --page-padding-x: 24px;
  --page-padding-y: 16px;
}
```

**关键规则**：

1. 代码中禁止出现硬编码的颜色值（除 token 文件外）
2. 圆角只使用 `--radius-sm/md/lg/full`
3. 阴影只使用 `--shadow-none/sm/md`
4. 任何新增颜色必须先加到 token，然后引用

#### 策略四：AI 交互范式库

**问题**：AI 产品中看不到 AI 能力。

**改进**：建立 AI 交互范式库，每个 AI 功能点必须选择一种范式。

```markdown
## AI 交互范式

### 范式 A：一键生成
适用于：背调报告、走访提纲、匹配分析
UI模式：按钮 → Loading → 结果卡片（可编辑）
示例：[AI 生成走访准备] → [生成中...] → [走访提纲 + 背调要点 + 话术建议]

### 范式 B：智能推荐列表
适用于：政策匹配企业、订单匹配、合作推荐
UI模式：列表/卡片 + 匹配度标签 + AI 分析摘要
示例：匹配企业卡片 → 匹配度 92% → [展开 AI 分析理由]

### 范式 C：异常预警 + AI 诊断
适用于：孵化器异常、政策风险、走访遗漏
UI模式：预警条 → 点击展开 → AI 分析原因 + 建议处理
示例：⚠️ XX企业会议频次骤降 → [AI 分析] 可能原因：...

### 范式 D：流程自动化 + 人确认
适用于：触达任务分发、需求分配、记录审核
UI模式：AI 自动完成 → 状态标记"待确认" → 人审阅 → 确认/退回
示例：AI 已自动分配 12 个触达任务 → [待确认] → 点击查看详情
```

#### 策略五：MEMORY 机制升级

**问题**：AI 在长对话和跨会话中"遗忘"之前的决策和反馈。

**改进**：

1. **每次 FDE 反馈后写入 MEMORY**：不只记"做了什么"，更记"FDE 不满意什么"
2. **建立"红线清单"**：FDE 明确说过"不要"的东西，永远不要再出现

```markdown
## 红线清单 ❌ 

> 以下是 FDE 明确否定过的设计决策，任何修改都不能违反：

1. ❌ 不要深色模式
2. ❌ 不要蓝紫渐变色
3. ❌ 不要大面积阴影
4. ❌ 不要 AI 廉价感的荧光色描边
5. ❌ 不要在员工页面放管理看板
6. ❌ 不要让 AI 功能页面只是静态展示
7. ❌ 不要在孵化器中打开企业库详情（应用内二级页面）
8. ❌ 不要跨 App 跳转（统一在一个 App 内完成）
```

3. **每次会话开始自动加载 MEMORY + 红线清单**：确保不会重蹈覆辙

---

## 五、Prompt 工程改进建议

### 5.1 FDE 侧的 Prompt 改进

| 问题模式 | 原始 Prompt | 改进后的 Prompt |
|---------|------------|----------------|
| 模糊描述 | "这个页面太奇怪了" | "这个页面的问题是：1.顶部空白太多 2.操作按钮和数据混在一起 3.缺少流程引导。参考飞书工作台的布局" |
| 多维混合 | "首页还是没优化" + "企业库需要改" + "管理看板也有问题" | 拆成 3 条独立 Prompt，每条聚焦一个页面 |
| 缺少验收标准 | "优化一下UI" | "UI 需要满足：1.所有 Tab 页内容宽度一致 2.卡片圆角统一 8px 3.无阴影或极轻阴影 4.参考飞书配色" |
| 缺少优先级 | 一次提 8 个问题 | "本次最重要的 3 个：1.XX 2.YY 3.ZZ。其他的后面再说" |

### 5.2 AI 侧的自我约束

| 约束规则 | 说明 |
|---------|------|
| **收到 prompt 后先确认不急着写代码** | 输出："我理解你的修改需求是……涉及文件是……不改的是……" |
| **每次修改前读 MEMORY** | 检查红线清单，确保不违反 |
| **每次修改后自检** | 检查其他页面是否受影响，布局是否还一致 |
| **单次修改 ≤ 3 个文件** | 超过 3 个文件的修改拆成多次 |
| **不主动做 FDE 没要求的事** | 例如 FDE 说"改配色"，就不要顺便重构布局 |

### 5.3 Prompt 模板

建议 FDE 使用标准化的 Prompt 模板：

```markdown
## 修改请求

### 要改的页面
- [ ] 首页
- [ ] 走访工作台
- [ ] ...

### 问题描述
1. [具体问题]
2. [具体问题]

### 期望效果
- 参考：[截图/链接/描述]
- 不要：[明确的红线]

### 优先级
- P0（必须改）：XX
- P1（尽量改）：YY
- P2（后面再说）：ZZ

### 验收标准
- [ ] 所有 Tab 页面宽度一致
- [ ] 无新增 lint error
- [ ] Mock 数据正常展示
```

---

## 六、Skill 与工具链改进建议

### 6.1 现有 Skill 使用情况评估

| Skill | 使用情况 | 效果 | 改进建议 |
|-------|---------|------|---------|
| **product** | Phase 1-3 使用充分 | ✅ 需求分析质量高 | Phase 4 衔接不足，设计稿不够细 |
| **north-app** | Phase 4 引用了架构 | ✅ 技术栈正确 | 缺少 UI 组件模式库 |
| **ui-ux-pro-max** | 后期引入 | 🟡 引入太晚，效果有限 | 应在 Phase 3 就引入 |
| **workflow-context** | 部分使用 | 🟡 MEMORY 有写但利用率低 | 红线清单机制缺失 |

### 6.2 建议新增/增强的 Skill

#### Skill A：`design-system`（设计系统）

```markdown
触发时机：项目初始化时
输出：
├── design-tokens.md          # Token 文档
├── tailwind.config.js        # Token → Tailwind 配置
├── index.css                 # CSS 变量
├── component-patterns.md     # 组件使用模式
└── anti-patterns.md          # 反面案例
```

#### Skill B：`ai-ux-patterns`（AI 交互范式库）

```markdown
触发时机：设计包含 AI 功能的页面时
输出：
├── AI 触点映射表
├── 交互范式选择
├── 组件代码模板（AIActionButton, AIResultCard...）
└── 状态机定义（idle→loading→success/error→confirmed）
```

#### Skill C：`regression-guard`（回归守卫）

```markdown
触发时机：每次代码修改后
操作：
├── 检查所有路由可达性
├── 检查布局一致性（宽度、间距）
├── 检查 mock 数据完整性
├── 检查 lint/type error
└── 输出变更报告
```

---

## 七、量化指标与改进目标

### 7.1 当前基线（漕河泾项目数据）

| 指标 | 数值 | 说明 |
|------|------|------|
| 总 Prompt 轮次 | ~30 轮 | 从初始到当前 |
| 重复反馈率 | 64% | 同一问题被提出 2 次以上 |
| 回归 Bug 次数 | 4 次 | 改A导致B出问题 |
| 布局不一致修复次数 | 3 次 | 同一问题修了多次 |
| 设计方向调整次数 | 5 次 | 审美方向反复 |
| 从需求到可用 Demo 的天数 | 2 天 | Phase 1-4 |
| 从 Demo 到"接近满意"的天数 | 3+ 天 | Phase 4 持续打磨 |

### 7.2 改进目标

| 指标 | 当前值 | 目标值 | 改进措施 |
|------|--------|--------|---------|
| 重复反馈率 | 64% | < 20% | 意图确认 + MEMORY 红线 |
| 回归 Bug | 4 次/项目 | 0-1 次 | 回归守卫 + 原子化修改 |
| 审美震荡次数 | 5 次 | 1 次 | Design Token 锁定 |
| 布局修复次数 | 3 次 | 0 次 | 共享布局组件 |
| Prompt 到满意 | 5-8 轮 | 2-3 轮 | 前置对齐 + 验收标准 |

---

## 八、方法论总结

### 8.1 Vibe Coding 的核心矛盾

**速度 vs 质量**：Vibe Coding 的优势是速度（1人+AI，2天出 Demo），劣势是质量不稳定（需要大量打磨轮次）。

**创造力 vs 一致性**：AI 每次生成都有随机性，这在创意阶段是优势，在规范化阶段是劣势。

### 8.2 解决矛盾的核心策略

```
Phase 1-3（创意阶段）：释放 AI 的创造力
  ↓ Design Token + 标杆参考 = "约束锚点"
Phase 4-6（执行阶段）：约束 AI 的自由度

关键转折点：Phase 3 → Phase 4 之间，必须建立约束体系
```

### 8.3 一句话总结

> **提高下限靠约束（Design Token + 共享组件 + 回归检查），提高上限靠认知（业务理解 + 用户旅程 + AI 交互范式）。**

两者缺一不可：
- 只有约束没有认知 = 一致但平庸的 UI
- 只有认知没有约束 = 偶尔闪光但整体混乱

### 8.4 下一步行动

| 优先级 | 行动项 | 负责 | 预期效果 |
|--------|-------|------|---------|
| P0 | 建立 Design Token 文件并锁定 | AI + FDE 确认 | 杜绝审美震荡 |
| P0 | 完善 MEMORY 红线清单 | AI 维护 | 杜绝重复犯错 |
| P0 | 共享布局组件完善并强制使用 | AI | 杜绝布局不一致 |
| P1 | 建立 AI 交互范式库 | AI + FDE 审查 | 提升 AI 产品感 |
| P1 | 标准化 Prompt 模板推广 | FDE | 减少理解偏差 |
| P1 | 每次修改后回归检查机制 | AI | 减少回归 Bug |
| P2 | 增加 Phase 3.5 交互设计稿 | AI | 提升设计质量 |
| P2 | 建立标杆参考库 | FDE + AI | 提升设计上限 |

---

## 附录 A：漕河泾项目已生成的分析文档索引

| 文档 | 路径 | 核心内容 |
|------|------|---------|
| 需求分析报告 | `docs/02-需求分析/需求分析报告.md` | 116 条需求的全景分析 |
| 场景分析（3份） | `docs/02-需求分析/场景分析-*.md` | 三个场景的业务流程分析 |
| 产品功能架构 | `docs/03-产品设计/产品功能架构.md` | 功能模块和数据架构 |
| App 设计（3份） | `docs/03-产品设计/App设计/*.md` | 三个App的页面设计 |
| Agent 设计汇总 | `docs/03-产品设计/Agent设计/Agent设计汇总.md` | 三个Agent的设计方案 |
| 架构与UX问题分析 | `docs/深度分析-架构与UX问题.md` | 嵌入小北的架构问题 |
| 设计偏离根因分析 | `docs/深度分析-v2-设计偏离根因.md` | 六条用户反馈的根因 |
| 业务流程重构方案 | `docs/深度分析-v3-业务流程与架构重构.md` | 三个场景的工作流梳理 |
| UI现状分析 | `docs/04-重构分析/UI现状深度分析-需求覆盖与AI展示.md` | 20个页面的需求覆盖 |
| 产品架构分析 | `docs/04-重构分析/产品架构深度分析.md` | 企业画像独立性等 |
| 前端重构分析 | `docs/04-重构分析/前端重构分析.md` | 技术重构方案 |
| 角色与HITL分析 | `docs/04-重构分析/角色分离与AI-HITL设计分析.md` | 人机协作设计 |
| 布局统一化记录 | `docs/布局统一化改造记录.md` | PageContainer等组件 |

## 附录 B：问题-措施-Skill 映射表

| 问题类型 | 出现频率 | 核心措施 | 对应 Skill |
|---------|---------|---------|-----------|
| 需求理解偏差 | 高 | 意图确认机制 | workflow-context（升级） |
| UI审美震荡 | 高 | Design Token 锁定 | design-system（新建） |
| 布局不一致 | 高 | 共享布局组件 | north-app（增强） |
| AI能力未展示 | 中 | AI 交互范式库 | ai-ux-patterns（新建） |
| 回归Bug | 中 | 回归守卫 | regression-guard（新建） |
| 角色混淆 | 中 | 角色标签机制 | product（增强） |

---

*本文档基于漕河泾驾驶舱（vibe-chj-demo）2026-02-09 ~ 2026-02-11 的完整开发过程撰写，所有数据和案例均来自真实的人机交互记录。*
